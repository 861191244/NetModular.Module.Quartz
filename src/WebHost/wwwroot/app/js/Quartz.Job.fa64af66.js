(window.webpackJsonp=window.webpackJsonp||[]).push([["Quartz.Job"],{6447:function(e,t,o){"use strict";o.r(t);var l=o("950b"),r=[{name:"id",label:"编号",width:250,show:!1},{name:"group",label:"任务组编号"},{name:"name",label:"任务名称"},{name:"jobClass",label:"任务类",width:"300"},{name:"triggerType",label:"触发器类型"},{name:"interval",label:"时间间隔"},{name:"repeatCount",label:"重复次数"},{name:"cron",label:"Cron表达式"},{name:"beginDate",label:"开始日期",format:"YYYY-MM-DD"},{name:"endDate",label:"结束日期",format:"YYYY-MM-DD"},{name:"status",label:"状态"},{name:"creator",label:"创建人",width:100,show:!1},{name:"createdTime",label:"创建时间",width:150,show:!1}],a=o("3ee3"),n=$api.quartz.job,s={mixins:[a.b.select],data:function(){return{action:n.moduleSelect}}},i=o("2877"),m=Object(i.a)(s,void 0,void 0,!1,null,null,null).exports,d=$api.quartz.job,u={mixins:[a.b.select],data:function(){return{action:this.query}},props:{moduleId:{type:String}},methods:{query:function(){return this.moduleId?d.jobSelect(this.moduleId):new Promise(function(e){e([])})}},watch:{moduleId:function(){this.refresh()}}},c=Object(i.a)(u,void 0,void 0,!1,null,null,null).exports,p=$api.quartz.group,f={mixins:[a.b.select],data:function(){return{action:p.select}}},g=Object(i.a)(f,void 0,void 0,!1,null,null,null).exports,b=$api.quartz.job,v={mixins:[a.b.dialog],components:{ModuleSelect:m,JobSelect:c,GroupSelect:g},data:function(){return{form:{title:"添加任务",icon:"add",width:"900px",labelWidth:"120px",action:b.add,model:{moduleCode:"",jobClass:"",group:"",name:"",code:"",triggerType:0,interval:5,repeatCount:0,cron:"",beginDate:"",endDate:""}},on:{success:this.onSuccess,open:this.onOpen}}},computed:{rules:function(){var e={moduleCode:[{required:!0,message:"请选择模块",trigger:"change"}],jobClass:[{required:!0,message:"请选择任务类",trigger:"change"}],group:[{required:!0,message:"请选择任务组",trigger:"change"}],name:[{required:!0,message:"请输入任务名称",trigger:"blur"}],code:[{required:!0,message:"请输入任务编码",trigger:"blur"}],beginDate:[{required:!0,message:"请选择开始日期",trigger:"change"}],endDate:[{required:!0,message:"请选择开始日期",trigger:"change"}]};return 0===this.form.model.triggerType?(e.interval=[{required:!0,message:"请输入执行间隔时间",trigger:"blur"},{type:"integer",min:1,message:"请输入整数且不能小于1",trigger:"blur"}],e.repeatCount=[{required:!0,message:"请输入执行次数",trigger:"blur"},{type:"integer",min:0,message:"请输入整数且不能小于0",trigger:"blur"}]):e.cron=[{required:!0,message:"请输入CRON表达式",trigger:"blur"}],e}},methods:{onSuccess:function(){this.$emit("success")},onOpen:function(){var e=this;this.$nextTick(function(){e.$refs.form.reset()})}}},y=Object(i.a)(v,function(){var o=this,e=o.$createElement,l=o._self._c||e;return l("nm-form-dialog",o._g(o._b({ref:"form",attrs:{rules:o.rules,visible:o.visible_},on:{"update:visible":function(e){o.visible_=e}}},"nm-form-dialog",o.form,!1),o.on),[l("el-row",[l("el-col",{attrs:{span:10,offset:1}},[l("el-form-item",{attrs:{label:"任务分组：",prop:"group"}},[l("group-select",{model:{value:o.form.model.group,callback:function(e){o.$set(o.form.model,"group",e)},expression:"form.model.group"}})],1)],1),l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"触发器类型：",prop:"triggerType"}},[l("el-radio-group",{model:{value:o.form.model.triggerType,callback:function(e){o.$set(o.form.model,"triggerType",e)},expression:"form.model.triggerType"}},[l("el-radio",{attrs:{label:0}},[o._v("简单触发器")]),l("el-radio",{attrs:{label:1}},[o._v("CRON触发器")])],1)],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:10,offset:1}},[l("el-form-item",{attrs:{label:"任务名称：",prop:"name"}},[l("el-input",{model:{value:o.form.model.name,callback:function(e){o.$set(o.form.model,"name",e)},expression:"form.model.name"}})],1)],1),l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"任务编码：",prop:"code"}},[l("el-input",{model:{value:o.form.model.code,callback:function(e){o.$set(o.form.model,"code",e)},expression:"form.model.code"}})],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:20,offset:1}},[l("el-form-item",{attrs:{label:"模块：",prop:"moduleCode"}},[l("module-select",{model:{value:o.form.model.moduleCode,callback:function(e){o.$set(o.form.model,"moduleCode",e)},expression:"form.model.moduleCode"}})],1),l("el-form-item",{attrs:{label:"任务类：",prop:"jobClass"}},[l("job-select",{attrs:{"module-id":o.form.model.moduleCode},scopedSlots:o._u([{key:"default",fn:function(e){var t=e.options;return o._l(t,function(e){return l("el-option",{key:e.value,attrs:{label:e.label+" ("+e.value+")",value:e.value}})})}}]),model:{value:o.form.model.jobClass,callback:function(e){o.$set(o.form.model,"jobClass",e)},expression:"form.model.jobClass"}})],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:10,offset:1}},[l("el-form-item",{attrs:{label:"开始日期：",prop:"beginDate"}},[l("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:o.form.model.beginDate,callback:function(e){o.$set(o.form.model,"beginDate",e)},expression:"form.model.beginDate"}})],1)],1),l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"结束日期：",prop:"endDate"}},[l("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:o.form.model.endDate,callback:function(e){o.$set(o.form.model,"endDate",e)},expression:"form.model.endDate"}})],1)],1)],1),0===o.form.model.triggerType?l("el-row",[l("el-col",{attrs:{span:10,offset:1}},[l("el-form-item",{attrs:{label:"间隔时间：",prop:"interval"}},[l("el-input",{attrs:{placeholder:"请输入执行时间间隔"},model:{value:o.form.model.interval,callback:function(e){o.$set(o.form.model,"interval",o._n(e))},expression:"form.model.interval"}},[l("template",{slot:"append"},[o._v("秒")])],2)],1)],1),l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"重复次数：",prop:"repeatCount"}},[l("el-input",{attrs:{placeholder:"请输入重复次数，0表示无限次"},model:{value:o.form.model.repeatCount,callback:function(e){o.$set(o.form.model,"repeatCount",o._n(e))},expression:"form.model.repeatCount"}},[l("template",{slot:"append"},[o._v("次")])],2)],1)],1)],1):l("el-row",[l("el-col",{attrs:{span:20,offset:1}},[l("el-form-item",{attrs:{label:"CRON表达式：",prop:"cron"}},[l("el-input",{attrs:{placeholder:"请输入CRON表达式"},model:{value:o.form.model.cron,callback:function(e){o.$set(o.form.model,"cron",e)},expression:"form.model.cron"}})],1)],1)],1)],1)},[],!1,null,null,null).exports,h=$api.quartz.job,_={mixins:[a.b.formDialogEdit],components:{ModuleSelect:m,JobSelect:c,GroupSelect:g},data:function(){return{api:h,form:{title:"编辑任务",width:"900px",labelWidth:"120px",action:h.update,model:{moduleCode:"",jobClass:"",group:"",name:"",code:"",triggerType:0,interval:5,repeatCount:0,cron:"",beginDate:"",endDate:""}}}},computed:{rules:function(){var e={moduleCode:[{required:!0,message:"请选择模块",trigger:"change"}],jobClass:[{required:!0,message:"请选择任务类",trigger:"change"}],group:[{required:!0,message:"请选择任务组",trigger:"change"}],name:[{required:!0,message:"请输入任务名称",trigger:"blur"}],code:[{required:!0,message:"请输入任务编码",trigger:"blur"}],beginDate:[{required:!0,message:"请选择开始日期",trigger:"change"}],endDate:[{required:!0,message:"请选择开始日期",trigger:"change"}]};return 0===this.form.model.triggerType?(e.interval=[{required:!0,message:"请输入执行间隔时间",trigger:"blur"},{type:"integer",min:1,message:"请输入整数且不能小于1",trigger:"blur"}],e.repeatCount=[{required:!0,message:"请输入执行次数",trigger:"blur"},{type:"integer",min:0,message:"请输入整数且不能小于0",trigger:"blur"}]):e.cron=[{required:!0,message:"请输入CRON表达式",trigger:"blur"}],e}}},k=Object(i.a)(_,function(){var o=this,e=o.$createElement,l=o._self._c||e;return l("nm-form-dialog",o._g(o._b({ref:"form",attrs:{rules:o.rules,visible:o.visible_},on:{"update:visible":function(e){o.visible_=e}}},"nm-form-dialog",o.form,!1),o.on),[l("el-row",[l("el-col",{attrs:{span:10,offset:1}},[l("el-form-item",{attrs:{label:"任务分组：",prop:"group"}},[l("group-select",{model:{value:o.form.model.group,callback:function(e){o.$set(o.form.model,"group",e)},expression:"form.model.group"}})],1)],1),l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"触发器类型：",prop:"triggerType"}},[l("el-radio-group",{model:{value:o.form.model.triggerType,callback:function(e){o.$set(o.form.model,"triggerType",e)},expression:"form.model.triggerType"}},[l("el-radio",{attrs:{label:0}},[o._v("简单触发器")]),l("el-radio",{attrs:{label:1}},[o._v("CRON触发器")])],1)],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:10,offset:1}},[l("el-form-item",{attrs:{label:"任务名称：",prop:"name"}},[l("el-input",{model:{value:o.form.model.name,callback:function(e){o.$set(o.form.model,"name",e)},expression:"form.model.name"}})],1)],1),l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"任务编码：",prop:"code"}},[l("el-input",{model:{value:o.form.model.code,callback:function(e){o.$set(o.form.model,"code",e)},expression:"form.model.code"}})],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:20,offset:1}},[l("el-form-item",{attrs:{label:"模块：",prop:"moduleCode"}},[l("module-select",{model:{value:o.form.model.moduleCode,callback:function(e){o.$set(o.form.model,"moduleCode",e)},expression:"form.model.moduleCode"}})],1),l("el-form-item",{attrs:{label:"任务类：",prop:"jobClass"}},[l("job-select",{attrs:{"module-id":o.form.model.moduleCode},scopedSlots:o._u([{key:"default",fn:function(e){var t=e.options;return o._l(t,function(e){return l("el-option",{key:e.value,attrs:{label:e.label+" ("+e.value+")",value:e.value}})})}}]),model:{value:o.form.model.jobClass,callback:function(e){o.$set(o.form.model,"jobClass",e)},expression:"form.model.jobClass"}})],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:10,offset:1}},[l("el-form-item",{attrs:{label:"开始日期：",prop:"beginDate"}},[l("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:o.form.model.beginDate,callback:function(e){o.$set(o.form.model,"beginDate",e)},expression:"form.model.beginDate"}})],1)],1),l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"结束日期：",prop:"endDate"}},[l("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:o.form.model.endDate,callback:function(e){o.$set(o.form.model,"endDate",e)},expression:"form.model.endDate"}})],1)],1)],1),0===o.form.model.triggerType?l("el-row",[l("el-col",{attrs:{span:10,offset:1}},[l("el-form-item",{attrs:{label:"间隔时间：",prop:"interval"}},[l("el-input",{attrs:{placeholder:"请输入执行时间间隔"},model:{value:o.form.model.interval,callback:function(e){o.$set(o.form.model,"interval",o._n(e))},expression:"form.model.interval"}},[l("template",{slot:"append"},[o._v("秒")])],2)],1)],1),l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"重复次数：",prop:"repeatCount"}},[l("el-input",{attrs:{placeholder:"请输入重复次数，0表示无限次"},model:{value:o.form.model.repeatCount,callback:function(e){o.$set(o.form.model,"repeatCount",o._n(e))},expression:"form.model.repeatCount"}},[l("template",{slot:"append"},[o._v("次")])],2)],1)],1)],1):l("el-row",[l("el-col",{attrs:{span:20,offset:1}},[l("el-form-item",{attrs:{label:"CRON表达式：",prop:"cron"}},[l("el-input",{attrs:{placeholder:"请输入CRON表达式"},model:{value:o.form.model.cron,callback:function(e){o.$set(o.form.model,"cron",e)},expression:"form.model.cron"}})],1)],1)],1)],1)},[],!1,null,null,null).exports,C=[{name:"id",label:"编号",show:!1},{name:"type",label:"类型",width:120},{name:"createdTime",label:"时间",width:150},{name:"msg",label:"信息",align:"left",showOverflowTooltip:!0}],x=$api.quartz.job,w={mixins:[a.b.dialog],data:function(){return{list:{noHeader:!0,noOperation:!0,cols:C,action:x.log,model:{jobId:"",startDate:"",endDate:""}}}},props:{job:{type:Object}},computed:{dialog:function(){return{title:"任务日志(".concat(this.job.name,")"),icon:"log"}}},methods:{onOpen:function(){this.list.model.jobId=this.job.id}}},$=Object(i.a)(w,function(){var o=this,e=o.$createElement,l=o._self._c||e;return l("nm-list-dialog",o._b({attrs:{visible:o.visible_},on:{"update:visible":function(e){o.visible_=e},open:o.onOpen}},"nm-list-dialog",o.dialog,!1),[l("nm-list",o._b({ref:"list",scopedSlots:o._u([{key:"querybar",fn:function(){return[l("el-form-item",{attrs:{label:"开始日期：",prop:"startDate"}},[l("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:o.list.model.startDate,callback:function(e){o.$set(o.list.model,"startDate",e)},expression:"list.model.startDate"}})],1),l("el-form-item",{attrs:{label:"结束日期：",prop:"endDate"}},[l("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:o.list.model.endDate,callback:function(e){o.$set(o.list.model,"endDate",e)},expression:"list.model.endDate"}})],1)]},proxy:!0},{key:"col-type",fn:function(e){var t=e.row;return[0===t.type?l("el-tag",{attrs:{type:"success",effect:"dark",size:"small"}},[o._v("信息")]):1===t.type?l("el-tag",{attrs:{type:"warning",effect:"dark",size:"small"}},[o._v("调试")]):l("el-tag",{attrs:{type:"danger",effect:"dark",size:"small"}},[o._v("异常")])]}}])},"nm-list",o.list,!1))],1)},[],!1,null,null,null).exports,D=$api.quartz.job,j={name:l.default.name,components:{AddPage:y,JobLog:$,EditPage:k},data:function(){return{curr:{id:"",name:""},list:{title:l.default.title,cols:r,operationWidth:"230",action:D.query,model:{name:""}},removeAction:D.remove,dialog:{add:!1,edit:!1,log:!1},buttons:l.default.buttons}},methods:{refresh:function(){this.$refs.list.refresh()},add:function(){this.dialog.add=!0},edit:function(e){this.curr=e,this.dialog.edit=!0},pause:function(e){this._confirm("您确定要暂停任务(".concat(e.name,")吗?"),"提醒").then(function(){D.pause(e.id).then(function(){e.status=1})})},resume:function(e){this._confirm("您确定要暂停启动(".concat(e.name,")吗?"),"提醒").then(function(){D.resume(e.id).then(function(){e.status=0})})},log:function(e){this.curr=e,this.dialog.log=!0}}},q=Object(i.a)(j,function(){var o=this,e=o.$createElement,l=o._self._c||e;return l("nm-container",[l("nm-list",o._b({ref:"list",scopedSlots:o._u([{key:"querybar",fn:function(){return[l("el-form-item",{attrs:{label:"名称：",prop:"name"}},[l("el-input",{attrs:{clearable:""},model:{value:o.list.model.name,callback:function(e){o.$set(o.list.model,"name",e)},expression:"list.model.name"}})],1)]},proxy:!0},{key:"querybar-buttons",fn:function(){return[l("nm-button-has",{attrs:{options:o.buttons.add},on:{click:o.add}})]},proxy:!0},{key:"col-jobClass",fn:function(e){var t=e.row;return[o._v(o._s(t.jobClass.split(",")[0]))]}},{key:"col-triggerType",fn:function(e){return[0===e.row.triggerType?l("el-tag",{attrs:{size:"small"}},[o._v("简单")]):l("el-tag",{attrs:{type:"warning",size:"small"}},[o._v("CRON")])]}},{key:"col-interval",fn:function(e){var t=e.row;return[0===t.triggerType?l("span",[o._v(o._s(t.interval)+"秒")]):l("span",[o._v("-")])]}},{key:"col-repeatCount",fn:function(e){var t=e.row;return[1===t.triggerType?l("span",[o._v("-")]):0===t.repeatCount?l("span",[o._v("无限次")]):l("span",[o._v(o._s(t.repeatCount)+"次")])]}},{key:"col-cron",fn:function(e){var t=e.row;return[0===t.triggerType?l("span",[o._v("-")]):l("span",[o._v(o._s(t.cron))])]}},{key:"col-status",fn:function(e){var t=e.row;return[0===t.status?l("el-tag",{attrs:{type:"success",effect:"dark",size:"small"}},[o._v("运行中")]):1===t.status?l("el-tag",{attrs:{type:"warning",effect:"dark",size:"small"}},[o._v("暂停")]):2===t.status?l("el-tag",{attrs:{type:"primary",effect:"dark",size:"small"}},[o._v("已完成")]):l("el-tag",{attrs:{type:"danger",effect:"dark",size:"small"}},[o._v("异常")])]}},{key:"col-operation",fn:function(e){var t=e.row;return[l("nm-button-has",{attrs:{options:o.buttons.edit},on:{click:function(e){return o.edit(t)}}}),0===t.status?l("nm-button-has",{attrs:{options:o.buttons.pause},on:{click:function(e){return o.pause(t)}}}):l("nm-button-has",{attrs:{options:o.buttons.resume},on:{click:function(e){return o.resume(t)}}}),l("nm-button-has",{attrs:{options:o.buttons.log},on:{click:function(e){return o.log(t)}}}),l("nm-button-delete",{attrs:{options:o.buttons.del,id:t.id,action:o.removeAction},on:{success:o.refresh}})]}}])},"nm-list",o.list,!1)),l("add-page",{attrs:{visible:o.dialog.add},on:{"update:visible":function(e){return o.$set(o.dialog,"add",e)},success:o.refresh}}),l("edit-page",{attrs:{id:o.curr.id,visible:o.dialog.edit},on:{"update:visible":function(e){return o.$set(o.dialog,"edit",e)},success:o.refresh}}),l("job-log",{attrs:{job:o.curr,visible:o.dialog.log},on:{"update:visible":function(e){return o.$set(o.dialog,"log",e)}}})],1)},[],!1,null,null,null);t.default=q.exports}}]);